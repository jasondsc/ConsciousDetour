---
title: "ValueGuidedConstrual"
output: html_document
date: "2024-05-03"
---

Let us take a new look at the data of Ho et al. 2022
and test whether environmental entropy has an impact on the awareness of subsequent stimuli 

```{r read in data}

library(ggplot2)

maze_meta_data = read.csv('~/Documents/ValueBasedConstrualTask/value-guided-construal-main/new_mazes_stats.csv')

maze_meta_data= maze_meta_data[-1]
maze_meta_data$lateralized= as.factor(maze_meta_data$lateralized)

# Plot the individuals
jitter_pos=position_jitter(width = .2, height = 0, seed = 1)

ggplot(maze_meta_data, aes(x=lateralized, y=goal_dist, color=lateralized, fill= lateralized))+  theme_classic() + xlab("") + geom_point(shape=21, color="white", size=5, position = jitter_pos, alpha=0.5)  + ylab("distance to goal") + scale_x_discrete(breaks=c("0","1"),
        labels=c("non-lateralized", "lateralized")) + theme(axis.text.x = element_text(size=14), axis.title.y = element_text(size=14), axis.text.y = element_text(size=14), legend.position = 'none') + scale_fill_manual(values=c('#B9E615', '#F36A17')) + geom_boxplot(width=0.1, colour= 'black', outliers = FALSE) 

ggsave('~/Documents/ValueBasedConstrualTask/value-guided-construal-main/results/R_plot_goal_distance.pdf', device = "pdf", width= 5, height =5)

ggplot(maze_meta_data, aes(x=lateralized, y=start_dist, color=lateralized, fill= lateralized))+  theme_classic() + xlab("") + geom_point(shape=21, color="white", size=5, position = jitter_pos, alpha=0.5)  + ylab("distance to start") + scale_x_discrete(breaks=c("0","1"),
        labels=c("non-lateralized", "lateralized")) + theme(axis.text.x = element_text(size=14), axis.title.y = element_text(size=14), axis.text.y = element_text(size=14), legend.position = 'none') + scale_fill_manual(values=c('#B9E615', '#F36A17')) + geom_boxplot(width=0.1, colour= 'black', outliers = FALSE) 

ggsave('~/Documents/ValueBasedConstrualTask/value-guided-construal-main/results/R_plot_start_distance.pdf', device = "pdf", width= 5, height =5)


ggplot(maze_meta_data, aes(x=lateralized, y=wall_dist, color=lateralized, fill= lateralized))+  theme_classic() + xlab("") + geom_point(shape=21, color="white", size=5, position = jitter_pos, alpha=0.5)  + ylab("distance to wall") + scale_x_discrete(breaks=c("0","1"),
        labels=c("non-lateralized", "lateralized")) + theme(axis.text.x = element_text(size=14), axis.title.y = element_text(size=14), axis.text.y = element_text(size=14), legend.position = 'none') + scale_fill_manual(values=c('#B9E615', '#F36A17')) + geom_boxplot(width=0.1, colour= 'black', outliers = FALSE) 

ggsave('~/Documents/ValueBasedConstrualTask/value-guided-construal-main/results/R_plot_wall_distance.pdf', device = "pdf", width= 5, height =5)


ggplot(maze_meta_data, aes(x=lateralized, y=center_dist, color=lateralized, fill= lateralized))+  theme_classic() + xlab("") + geom_point(shape=21, color="white", size=5, position = jitter_pos, alpha=0.5)  + ylab("distance to centre") + scale_x_discrete(breaks=c("0","1"),
        labels=c("non-lateralized", "lateralized")) + theme(axis.text.x = element_text(size=14), axis.title.y = element_text(size=14), axis.text.y = element_text(size=14), legend.position = 'none') + scale_fill_manual(values=c('#B9E615', '#F36A17')) + geom_boxplot(width=0.1, colour= 'black', outliers = FALSE) 

ggsave('~/Documents/ValueBasedConstrualTask/value-guided-construal-main/results/R_plot_centre_distance.pdf', device = "pdf", width= 5, height =5)

ggplot(maze_meta_data, aes(x=lateralized, y= log10(dVGC), color=lateralized, fill= lateralized))+  theme_classic() + xlab("") + geom_point(shape=21, color="white", size=5, position = jitter_pos, alpha=0.5)  + ylab("log 10 dynamic VGC") + scale_x_discrete(breaks=c("0","1"),
        labels=c("non-lateralized", "lateralized")) + theme(axis.text.x = element_text(size=14), axis.title.y = element_text(size=14), axis.text.y = element_text(size=14), legend.position = 'none') + scale_fill_manual(values=c('#B9E615', '#F36A17')) + geom_boxplot(width=0.1, colour= 'black', outliers = FALSE) 

ggsave('~/Documents/ValueBasedConstrualTask/value-guided-construal-main/results/R_plot_dynamic_VGC.pdf', device = "pdf", width= 5, height =5)

```





```{r entropy}

json_data <- rjson::fromJSON(file='~/Documents/ValueBasedConstrualTask/value-guided-construal-main/experiments/mazes/mazes_0-11.json')


entropy_maze <- function(maze, n, m){
  m=11
  n=11
  sum_dot=stringr::str_count(paste(unlist(maze),collapse=""), "\\.")
  
  sum_not= (m*n)-sum_dot
  
  entropy=((-(sum_dot)/(m*n))* log2((sum_dot)/(m*n)))- (((sum_dot)/(m*n))* log2((sum_dot)/(m*n)))
  return(entropy)
}

entropy_maze(json_data[["grid-0-0"]], 11, 11)




```